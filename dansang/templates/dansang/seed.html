{% extends 'main/base.html' %}
{% load mathfilters %}
{% load static %}
{% block css %}
<link rel="stylesheet" href="{% static 'dansang/dansang.css' %}">
{% endblock %}

{% block title %} ìƒê°ì˜ ì”¨ì•— {% endblock %}

{% load crispy_forms_tags %}

{% block content %}
<div class="row block-spacing"></div>

<div class="row top-block">
    <div class="col col-12 text-left">
        <span class="archive-title">ìƒê°ì˜ ì”¨ì•—</span><span class="archive-icon">ğŸŒ±</span>
    </div>
    <div class="col col-12 text-left">
        <div class="archive-subtitle">ë‹¤ì±„ë¡œìš´ ìƒê°ê³¼ ê´€ì ì„ ê°–ê¸° ìœ„í•´ì„œëŠ” ë‹¤ì–‘í•œ <span class="seed-intro">ì¸í’‹(input)</span>ì´ í•„ìˆ˜ë¼ê³  ë¯¿ì–´ìš”.<br>
            ì´ëŸ¬í•œ ìê·¹ë“¤ì€ ì¢‹ì€ <span class="seed-intro">ìƒê°ì˜ ì”¨ì•—</span>ì´ ë˜ì–´ ì–¸ì  ê°€ëŠ” ë‚˜ë§Œì˜ <span class="seed-intro">ì•„ì›ƒí’‹(output)</span>ìœ¼ë¡œ ìë¼ë‚©ë‹ˆë‹¤!<br>
            <span class="helptext">*ì”¨ì•—ì€ í•˜ë£¨ì— í•˜ë‚˜ì”© ì¶”ê°€ë¼ìš”!</span></div>
    </div>
</div>
<br>
<!-- <div class="row">
    <div class="col col-6 button-new">
        <a href="/dansang/dansanginput">
            <button class="all-buttons btn-lg btn-sm btn-primary">âœ’ï¸ ìƒê° ë„ì ì´ê¸°</button>
        </a>
    </div>
</div> -->

<div class="row">
    <div class="col col-6">
        <div class="dropdown">
            <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <strong>ì”¨ì•— ì¹´í…Œê³ ë¦¬</strong>
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <button class="dropdown-item" id="seeAllCat">ì „ì²´ ë³´ê¸°</button>
              <div class="dropdown-divider"></div>
              {% for cat in categoriesInEng %}
              <button class="dropdown-item {{cat.category_eng}}" id="{{cat.category_eng}}">{{cat.in_kor}}</button>
              {% endfor %}
            </div>
          </div>
    </div>
</div>


{% for item in posts %}
<div class="row seed-row allCat all-{{item.category_eng}}">
    <a href="{{item.url}}" onclick="add_one_click({{item.pk}})" class="all-links seed-links" id="seed-{{forloop.counter}}" target="_blank" rel="noopener noreferrer">
    <div class="col">
        <span class="seed-title">{{item.title}}</span><br class="mobile-only">
        <span class="seed-subtitle"> | {{item.subtitle}}</span>
    </div>  
    </a>
</div>
{% endfor %}

{% for item in posts %}
<div class="row seed-row eachCat each-{{item.category_eng}}">
    <a href="{{item.url}}" onclick="add_one_click({{item.pk}})" class="all-links seed-links" id="seed-{{forloop.counter}}" target="_blank" rel="noopener noreferrer">
    <div class="col">
        <span class="seed-title">{{item.title}}</span><br class="mobile-only">
        <span class="seed-subtitle"> | {{item.subtitle}}</span>
    </div>  
    </a>
</div>
{% endfor %}

<br>
<div class="row allCat">
    <div class="col text-center">
        {% if posts.has_previous %}
        <a href="?page=1">âª</a>
        <a href="?page={{posts.previous_page_number}}">â¬…ï¸</a>
        {% elif not posts.has_previous %}
        <a href="">âª</a>
        <a href="">â¬…ï¸</a>
        {% endif %}
        <span>{{posts.number}}</span>
        <span>/</span>
        <span>{{posts.paginator.num_pages}}</span>
        {% if posts.has_next %}
        <a href="?page={{posts.next_page_number}}">â¡ï¸</a>
        <a href="?page={{posts.paginator.num_pages}}">â©</a>
        {% elif not posts.has_next %}
        <a href="">â¡ï¸</a>
        <a href="">â©</a>
        {% endif %}
    </div>
</div>

<div class="manual">
    <button class="btn manual-button" id="manual-dansang">
        ğŸ“‹ ì‚¬ìš©ë²•
    </button>
</div>
<!-- </div> -->
<div class="block-spacing"></div>
<div class="block-spacing"></div>

<script>
    // Seed í´ë¦­ìˆ˜ ì„¸ê¸°
    function add_one_click(seedId) {
        $.ajax({
            type: "GET",
            url: '{% url "add_click" %}', // '/ajax/add_click',
            data: {
                'seedId': seedId,
            }, error:function(request,status,error){
                alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);}
        });
    }

    $(document).ready(function(){
        // ì²˜ìŒì— ë¡œë“œë  ë•ŒëŠ” ìˆ¨ê¹€
        $('.eachCat').hide();

        $('.dropdown-toggle').dropdown();

        // ìƒˆë¡œìš´ ì•„ì´í…œì— ë±ƒì§€ ì¶”ê°€
        $('#seed-1').children('.col').children('.seed-title').append("<span class='badge badge-primary seed-badge'>New!</span>");
        // 'ì „ì²´ë³´ê¸°' í´ë¦­í–ˆì„ ë•Œ
        $('#seeAllCat').click(function() {
            $('.eachCat').hide();
            $('.allCat').show();
        })

        // ê° ì¹´í…Œê³ ë¦¬ í´ë¦­í–ˆì„ ë•Œ
        $('.dropdown-item').click(function(event) {
            var thisCat = String(event.target.id);
            console.log(thisCat)
            console.log(`${thisCat}`)
            if (thisCat === 'seeAllCat') {
                $('.allCat').show();
            } else {
                $('.allCat').hide();
                $('.eachCat').hide();
                $(`.each-${thisCat}`).show();
            } 
        })
    })

</script>
{% endblock %}