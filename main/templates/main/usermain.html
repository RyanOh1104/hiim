{% extends 'main/usermain-base.html' %}

{% load static %}
{% block css %}
<link rel="stylesheet" href="{% static '/main/usermain.css' %}">
{% endblock %}

{% block title %} Hi, I'm {{thisUser.name}}! {% endblock %}

{% load crispy_forms_tags %}

{% block content %}

<div class="main-first-page">
    <div class="row h-25"></div>

    <div class="row h-25 justify-content-center">
        <div class="col usermain-block">
            <div class="row justify-content-center ci-and-name" style="align-items:  center;">
                <div class="col col-8" id="usermain-ci">
                    <img class="usermain-ci" src="/static/mvp/images/ci.png">
                    <span class="usermain-name" id="tooltip-alert" data-toggle="tooltip" data-placement="top" title="내 정보를 수정할 수 있어요!"><span class="highlight" onclick="location.href=`{% url 'update' thisUser.authuser_id %}`"> {{thisUser.name}}</span></span>
                </div>
            </div>
            
            <!-- ORIGINAL VERSION 
                <div class="row justify-content-center ci-and-name">
                <div class="col col-3" id="usermain-ci">
                    <img class = "usermain-ci" src="{% static 'mvp/images/ci.png' %}">
                </div>
                <div class="col col-3 text-center">
                    <div class="usermain-name"><span class="highlight" onclick="location.href=`{% url 'update' thisUser.authuser_id %}`">{{thisUser.name}}</span></div>
                </div>
            </div> -->
            <div class="row justify-content-center">
                <div class="col col-12 text-center">
                    <div class="usermain-intro">{{thisUser.introduction}}</div>
                </div>
            </div>
        </div>
    </div>
    <div class="row h-25">
        <div class="col text-center scroll-down">
            <img class="scroll-down-img" src="{%static 'mvp/images/down.png' %}"
            onclick="scrollWin(0,750)">
        </div>
    </div>
</div>

<div class="main-second-page container">
    <div class="row justify-content-center">
        <div class="col col-10">
            <div class="row justify-content-center social-media">
                <div class="col col-lg-4 col-sm-10">
                    <div class="row justify-content-center">
                        <div class="col col-2">
                            <a href="https://www.instagram.com/{{thisUser.insta}}"><img class="img-websites" src="{% static 'mvp/images/insta.png' %}"></a>
                        </div>
                        <div class="col col-2">
                            <a href="{{thisUser.facebook}}"><img class="img-websites" src="{% static 'mvp/images/facebook.png' %}"></a>
                        </div>
                        <div class="col col-2">
                            <a href="{{thisUser.linkedin}}"><img class="img-websites" src="{% static 'mvp/images/linkedin.png' %}"></a>
                        </div>
                        <div class="col col-2">
                            <a href="{{thisUser.youtube}}"><img class="img-websites" src="{% static 'mvp/images/youtube.png' %}"></a>
                        </div>
                        <div class="col col-2">
                            <a href="{{thisUser.blog}}"><img class="img-websites" src="{% static 'mvp/images/blog.png' %}"></a>
                        </div>
                        <div class="col col-2">
                            <a href="{{thisUser.others}}"><img class="img-websites" src="{% static 'mvp/images/others.png' %}"></a>
                        </div>
                    </div>
                </div>  
            </div>
            
            <br>
            
            <!-- <div class="row justify-content-center">
                <div class="col my-archive text-center">기록장</div>
            </div> -->

            <div class="row justify-content-center">
                <div class="col-sm-10 col-lg-4 archive-outer-block">
                    <div class="row justify-content-center archive-block">
                        <div class="col col-11 usermain-archive-content all-blocks">
                            <a href="/dansang/dansangmain" class="all-links">
                                <div class="row archive-block" id="alert-newSeed" data-toggle="tooltip" data-placement="bottom" title="새로운 씨앗이 추가되었어요! '{{newSeed.title}}'">
                                    <div class="col my-auto text-center">
                                        <span class="usermain-archive-name">끄적끄적<span class=usermain-archive-desc>💬</span><br></span>
                                        <span class="usermain-archive-desc">떠오르는 아무 생각이나. 자유롭게.</span>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-sm-10 col-lg-4 archive-outer-block">
                    <div class="row justify-content-center archive-block">
                        <div class="col col-11 usermain-archive-content all-blocks">
                            <a href="/everyday/everydaymain" class="all-links">
                                <div class="row archive-block">
                                    <div class="col my-auto text-center">
                                        <span class="usermain-archive-name">지나갈 오늘<span class=usermain-archive-desc>📅</span><br></span>
                                        <span class="usermain-archive-desc">일상은 추억이 되거나, 사라진 기억이 되거나.</span>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-sm-10 col-lg-4 archive-outer-block">
                    <div class="row justify-content-center archive-block">
                        <div class="col col-11 usermain-archive-content coming-soon">
                                <div class="row archive-block">
                                    <div class="col my-auto text-center">
                                        <span class="usermain-archive-name">Coming Soon<span class=usermain-archive-desc>🔨</span><br></span>
                                        <span class="usermain-archive-desc">조금만 기다려주세요!</span>
                                    </div>
                                </div>
                        </div>
                    </div>
                </div>
                        <!-- <div class="col col-4">
                    <div class="row justify-content-center usermain-block">
                        <div class="col col-11 usermain-archive-content all-blocks">
                            <a href="/history/historymain" class="all-links">
                                <div class="row usermain-block">
                                    <div class="col my-auto text-center">
                                        📜📍👣📌
                                        <span class="usermain-archive-name">역사<span class=usermain-archive-desc>📜</span><br></span>
                                        <span class="usermain-archive-desc">지금의 나는 내가 쌓아온 순간들의 합.</span>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div> -->
            </div>
            <div class="row h-75 pc-only"></div>
            <div class="row h-25 pc-only"></div>
        </div>
    </div>
</div>

<!-- <div class="row">
    <div class="col col-12">
            <div class="row">
                <div class="col col-12 text-center">
                    <a href="#"><img class="img-add-archive for-authuser" src="{% static 'mvp/images/add.png' %}"></a>
                </div>
            </div>
    </div>
</div> -->

<script>
    function scrollWin(x, y) {
        window.scrollBy(x, y);
      }

    function setCookie(cname, cvalue, exdays) {
        // Expiration 날짜 정하기
        var d = new Date();
        d.setTime(d.getTime() + (exdays*24*60*60*1000));
        var expires = "expires="+ d.toUTCString();

        document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
    }

    function getCookie(cname) {
        var name = cname + "=";
        var ca = document.cookie.split(';');
        for(var i = 0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) == ' ') {
            c = c.substring(1);
            }
            if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
            }
        }
        return "";
    }
    
    setCookie('newSeed', '2020/07/01', 3650); // 처음 한번만 실행?
    function NewSeedAlert() {
        // 오늘 날짜 가져오기

        var todayDate = new Date();
        var dd = String(todayDate.getDate()).padStart(2, '0');
        var mm = String(todayDate.getMonth() + 1).padStart(2, '0'); //January is 0!
        var yyyy = todayDate.getFullYear();
        todayDate =  yyyy + '/' + mm + '/' + dd;;

        var todayCookie = getCookie("newSeed"); // 'newSeed'라는 이름을 가진 쿠키의 value 가져오기
        if (todayCookie == `'${todayDate}'`) {
            
        } else if (todayCookie != `'${todayDate}'`) {           
            $('#alert-newSeed').tooltip('show');
            setTimeout(function(){
            $('#alert-newSeed').tooltip('dispose')
            }, 10000)

            document.cookie = `newSeed = '${todayDate}'`

        }
    }  

    function NewSeedAlerts() {
        // 오늘 날짜 가져오기
        var todayDate = new Date();
        var dd = String(todayDate.getDate()).padStart(2, '0');
        var mm = String(todayDate.getMonth() + 1).padStart(2, '0'); //January is 0!
        var yyyy = todayDate.getFullYear();
        todayDate =  yyyy + '/' + mm + '/' + dd;;

        var todaySeedAlert = localStorage.getItem("newSeed");
        if (todaySeedAlert == null || todaySeedAlert != `'${todayDate}'`) {
            $('#alert-newSeed').tooltip('show');
            
            setTimeout(function(){
            $('#alert-newSeed').tooltip('dispose')
            }, 10000);

            todaySeedAlert = `'${todayDate}'`;

        } else if (todaySeedAlert == `'${todayDate}'`) {           
        }
    }  

    window.onload = function () {
        // 개인정보 수정 alert
        if(localStorage.getItem("popupWasShown") == null) {
            $('#tooltip-alert').tooltip('show');
            //Hide tooltip after three seconds
            setTimeout(function(){
            $('#tooltip-alert').tooltip('dispose')
            }, 5000)

            localStorage.setItem("popupWasShown", 1)
        } else if (localStorage.getItem("popupWasShown", 1)) {
            $('#tooltip-alert').tooltip('hide');
        }

        NewSeedAlerts();
}
</script>
{% endblock %}